{"version":3,"file":"view.js","mappings":"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","sources":["webpack://vml-fixtures/./src/view.js"],"sourcesContent":["\"use strict\";\r\n\r\njQuery(function ($) {\r\n\tconst ajax_url = $(\"div#topdf\").data(\"ajax-url\");\r\n\r\n\tfunction setButtonLoadingState($button, isLoading) {\r\n\t\tif (isLoading) {\r\n\t\t\t$button.attr(\"disabled\", \"disabled\").attr(\"data-loading\", \"true\");\r\n\t\t} else {\r\n\t\t\t$button.removeAttr(\"disabled\").removeAttr(\"data-loading\");\r\n\t\t}\r\n\t}\r\n\r\n\tfunction displayError(errorMessage, $errorDialog) {\r\n\t\tconsole.error(\"Error:\", errorMessage); // log the error message\r\n\t\t$errorDialog.text(errorMessage).show();\r\n\t}\r\n\r\n\tfunction sendAddToCartRequest(products, button) {\r\n\t\tconsole.log(\"Sending request with products:\", products); // log the products data\r\n\r\n\t\tconst $button = $(button);\r\n\t\tconst $commonAncestor = $button.closest(\".common-container\");\r\n\t\tconst $loadingMessageElement = $button.find(\".js-loadingMsg\");\r\n\t\tconst $successDialog = $commonAncestor.find(\".addToCart-success\");\r\n\t\tconst $errorDialog = $commonAncestor.find(\".addToCart-fail\");\r\n\r\n\t\tsetButtonLoadingState($button, true);\r\n\t\t$loadingMessageElement.text($loadingMessageElement.data(\"loading-msg\"));\r\n\t\t$successDialog.hide();\r\n\t\t$errorDialog.hide();\r\n\r\n\t\tif (!products || products.length === 0) {\r\n\t\t\tdisplayError(\r\n\t\t\t\t\"Product information is missing. Please try again.\",\r\n\t\t\t\t$errorDialog,\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst data = {\r\n\t\t\taction: \"vizmerch_add_to_cart\",\r\n\t\t\tproducts: products,\r\n\t\t};\r\n\r\n\t\tconsole.log(\"Sending request with data:\", data); // log the products data\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: ajax_url,\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: $.param(data),\r\n\t\t})\r\n\t\t\t.done(function (data) {\r\n\t\t\t\tconsole.log(\"Request successful, received data:\", data); // log the success data\r\n\t\t\t\tif (data.error) {\r\n\t\t\t\t\tdisplayError(data.error, $errorDialog);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t$successDialog.show();\r\n\t\t\t\tcart_info.count += products.length;\r\n\t\t\t\tupdateCartCount();\r\n\t\t\t})\r\n\t\t\t.fail(function (jqXHR) {\r\n\t\t\t\tconsole.error(\"Request failed:\", jqXHR); // log the failure object\r\n\t\t\t\tlet errorMessage =\r\n\t\t\t\t\t\"There has been a problem adding the items to the cart. Please try again later.\";\r\n\t\t\t\tif (jqXHR.responseJSON && jqXHR.responseJSON.error) {\r\n\t\t\t\t\terrorMessage = jqXHR.responseJSON.error;\r\n\t\t\t\t}\r\n\t\t\t\tdisplayError(errorMessage, $errorDialog);\r\n\t\t\t})\r\n\t\t\t.always(function () {\r\n\t\t\t\tsetButtonLoadingState($button, false);\r\n\t\t\t\t$loadingMessageElement.text(\"\");\r\n\t\t\t});\r\n\t}\r\n\r\n\t$(document).on(\"click\", \"button.add-cart\", function (event) {\r\n\t\tconst $button = $(event.target).closest(\"button\");\r\n\t\tconst product_id = $button.data(\"product-id\");\r\n\t\tconst product_code = $button.data(\"product-code\");\r\n\t\tsendAddToCartRequest(\r\n\t\t\t[{ product_id: product_id, product_code: product_code, qty: 1 }],\r\n\t\t\t$button[0],\r\n\t\t);\r\n\t});\r\n\r\n\twindow.handleAddShelfToCart = function (products) {\r\n\t\tconst $button = $(event.target).closest(\"button\");\r\n\t\tsendAddToCartRequest(products, $button[0]);\r\n\t};\r\n\r\n\twindow.openDialog = function (id) {\r\n\t\tdocument.getElementById(id).showModal();\r\n\t};\r\n\r\n\twindow.closeDialog = function (id) {\r\n\t\tdocument.getElementById(id).close();\r\n\t};\r\n\r\n\t/* Handle clicks on the backdrop */\r\n\tdocument.addEventListener(\r\n\t\t\"click\",\r\n\t\tfunction (e) {\r\n\t\t\tif (e.target instanceof HTMLDialogElement && e.target.open) {\r\n\t\t\t\twindow.closeDialog(e.target.id);\r\n\t\t\t}\r\n\t\t},\r\n\t\tfalse,\r\n\t);\r\n});\r\n"],"names":["jQuery","$","ajax_url","data","setButtonLoadingState","$button","isLoading","attr","removeAttr","displayError","errorMessage","$errorDialog","console","error","text","show","sendAddToCartRequest","products","button","log","$commonAncestor","closest","$loadingMessageElement","find","$successDialog","hide","length","action","ajax","url","type","param","done","cart_info","count","updateCartCount","fail","jqXHR","responseJSON","always","document","on","event","target","product_id","product_code","qty","window","handleAddShelfToCart","openDialog","id","getElementById","showModal","closeDialog","close","addEventListener","e","HTMLDialogElement","open"],"sourceRoot":""}